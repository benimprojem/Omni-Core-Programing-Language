// TEST 20: Kapsamlı Entegrasyon Testi
// Beklenen: Tüm özelliklerin birlikte çalışması

struct Ogrenci {
    ad: str,
    yas: i32,
    not_ort: f64
}

fn not_hesapla(notlar: arr): f64 {
    var toplam: i32 = 0;
    for (not in notlar) {
        toplam = toplam + not;
    }
    var len: i32 = arrlen(notlar);
    var ortalama: f64 = _float(toplam) / _float(len);
    return ortalama;
}

fn gecti_mi(ortalama: f64): bool {
    if (ortalama >= 50.0) {
        return true;
    }
    return false;
}

fn main(): i32 {
    echo("=== TEST 20: KAPSAMLI ENTEGRASYON TESTİ ===\n");
    
    // Öğrenci bilgileri
    var ogr: Ogrenci;
    ogr.ad = "Ahmet";
    ogr.yas = 20;
    
    // Notlar
    var notlar: arr = [85, 90, 75, 80, 95];
    echo("Öğrenci: {ogr.ad}, Yaş: {ogr.yas}\n");
    echo("Notlar: ");
    for (not in notlar) {
        echo("{not} ");
    }
    echo("\n");
    
    // Ortalama hesaplama
    var ort: f64 = not_hesapla(notlar);
    ogr.not_ort = ort;
    echo("Not Ortalaması: {ort}\n");
    
    // Geçme durumu
    if (gecti_mi(ort)) {
        print("success", "Öğrenci GEÇTİ!\n");
    } else {
        print("error", "Öğrenci KALDI!\n");
    }
    
    // İstatistikler
    echo("\n--- İstatistikler ---\n");
    var toplam_not: i32 = 0;
    var max_not: i32 = notlar[0];
    var min_not: i32 = notlar[0];
    
    for (not in notlar) {
        toplam_not = toplam_not + not;
        if (not > max_not) {
            max_not = not;
        }
        if (not < min_not) {
            min_not = not;
        }
    }
    
    echo("Toplam: {toplam_not}\n");
    echo("En Yüksek: {max_not}\n");
    echo("En Düşük: {min_not}\n");
    
    // Başarı yüzdesi
    var basari_yuzdesi: f64 = (ort / 100.0) * 100.0;
    echo("Başarı Yüzdesi: {basari_yuzdesi}%\n");
    
    echo("\n=== TEST 20 TAMAMLANDI ===\n");
    echo("=== TÜM TESTLER BİTTİ ===\n");
    return 0;
}
